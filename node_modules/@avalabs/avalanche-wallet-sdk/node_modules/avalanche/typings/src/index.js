"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.PubSub = exports.Socket = exports.Buffer = exports.BN = exports.AvalancheCore = exports.DB = exports.BinTools = exports.Avalanche = void 0;
/**
 * @packageDocumentation
 * @module Avalanche
 */
const avalanche_1 = __importDefault(require("./avalanche"));
exports.AvalancheCore = avalanche_1.default;
const api_1 = require("./apis/admin/api");
const api_2 = require("./apis/auth/api");
const api_3 = require("./apis/avm/api");
const api_4 = require("./apis/evm/api");
const api_5 = require("./apis/health/api");
const api_6 = require("./apis/index/api");
const api_7 = require("./apis/info/api");
const api_8 = require("./apis/keystore/api");
const api_9 = require("./apis/metrics/api");
const api_10 = require("./apis/platformvm/api");
const socket_1 = require("./apis/socket/socket");
Object.defineProperty(exports, "Socket", { enumerable: true, get: function () { return socket_1.Socket; } });
const pubsub_1 = require("./utils/pubsub");
Object.defineProperty(exports, "PubSub", { enumerable: true, get: function () { return pubsub_1.PubSub; } });
const constants_1 = require("./utils/constants");
const helperfunctions_1 = require("./utils/helperfunctions");
const bintools_1 = __importDefault(require("./utils/bintools"));
exports.BinTools = bintools_1.default;
const db_1 = __importDefault(require("./utils/db"));
exports.DB = db_1.default;
const bn_js_1 = __importDefault(require("bn.js"));
exports.BN = bn_js_1.default;
const buffer_1 = require("buffer/");
Object.defineProperty(exports, "Buffer", { enumerable: true, get: function () { return buffer_1.Buffer; } });
/**
 * AvalancheJS is middleware for interacting with Avalanche node RPC APIs.
 *
 * Example usage:
 * ```js
 * let avalanche = new Avalanche("127.0.0.1", 9650, "https");
 * ```
 *
 */
class Avalanche extends avalanche_1.default {
    /**
       * Creates a new Avalanche instance. Sets the address and port of the main Avalanche Client.
       *
       * @param ip The hostname to resolve to reach the Avalanche Client RPC APIs
       * @param port The port to resolve to reach the Avalanche Client RPC APIs
       * @param protocol The protocol string to use before a "://" in a request,
       * ex: "http", "https", "git", "ws", etc ...
       * @param networkid Sets the NetworkID of the class. Default [[DefaultNetworkID]]
       * @param XChainID Sets the blockchainID for the AVM. Will try to auto-detect,
       * otherwise default "4R5p2RXDGLqaifZE4hHWH9owe34pfoBULn1DrQTWivjg8o4aH"
       * @param CChainID Sets the blockchainID for the EVM. Will try to auto-detect,
       * otherwise default "2q9e4r6Mu3U68nU1fYjgbR6JvwrRx36CohpAX5UQxse55x1Q5"
       * @param hrp The human-readable part of the bech32 addresses
       * @param skipinit Skips creating the APIs
       */
    constructor(ip, port, protocol = 'http', networkID = constants_1.DefaultNetworkID, XChainID = undefined, CChainID = undefined, hrp = undefined, skipinit = false) {
        super(ip, port, protocol);
        /**
           * Returns a reference to the Admin RPC.
           */
        this.Admin = () => this.apis.admin;
        /**
           * Returns a reference to the Auth RPC.
           */
        this.Auth = () => this.apis.auth;
        /**
         * Returns a reference to the EVMAPI RPC pointed at the C-Chain.
         */
        this.CChain = () => this.apis.cchain;
        /**
           * Returns a reference to the AVM RPC pointed at the X-Chain.
           */
        this.XChain = () => this.apis.xchain;
        /**
           * Returns a reference to the Health RPC for a node.
           */
        this.Health = () => this.apis.health;
        /**
           * Returns a reference to the Index RPC for a node.
           */
        this.Index = () => this.apis.index;
        /**
           * Returns a reference to the Info RPC for a node.
           */
        this.Info = () => this.apis.info;
        /**
           * Returns a reference to the Metrics RPC.
           */
        this.Metrics = () => this.apis.metrics;
        /**
           * Returns a reference to the Keystore RPC for a node. We label it "NodeKeys" to reduce
           * confusion about what it's accessing.
           */
        this.NodeKeys = () => this.apis.keystore;
        /**
           * Returns a reference to the PlatformVM RPC pointed at the P-Chain.
           */
        this.PChain = () => this.apis.pchain;
        let xchainid = XChainID;
        let cchainid = CChainID;
        if (typeof XChainID === 'undefined'
            || !XChainID
            || XChainID.toLowerCase() === 'x') {
            if (networkID.toString() in constants_1.Defaults.network) {
                xchainid = constants_1.Defaults.network[networkID].X.blockchainID;
            }
            else {
                xchainid = constants_1.Defaults.network[12345].X.blockchainID;
            }
        }
        if (typeof CChainID === 'undefined'
            || !CChainID
            || CChainID.toLowerCase() === 'c') {
            if (networkID.toString() in constants_1.Defaults.network) {
                cchainid = constants_1.Defaults.network[networkID].C.blockchainID;
            }
            else {
                cchainid = constants_1.Defaults.network[12345].C.blockchainID;
            }
        }
        if (typeof networkID === 'number' && networkID >= 0) {
            this.networkID = networkID;
        }
        else if (typeof networkID === "undefined") {
            networkID = constants_1.DefaultNetworkID;
        }
        if (typeof hrp !== "undefined") {
            this.hrp = hrp;
        }
        else {
            this.hrp = helperfunctions_1.getPreferredHRP(this.networkID);
        }
        if (!skipinit) {
            this.addAPI('admin', api_1.AdminAPI);
            this.addAPI('auth', api_2.AuthAPI);
            this.addAPI('xchain', api_3.AVMAPI, '/ext/bc/X', xchainid);
            this.addAPI('cchain', api_4.EVMAPI, '/ext/bc/C/avax', cchainid);
            this.addAPI('health', api_5.HealthAPI);
            this.addAPI('info', api_7.InfoAPI);
            this.addAPI('index', api_6.IndexAPI);
            this.addAPI('keystore', api_8.KeystoreAPI);
            this.addAPI('metrics', api_9.MetricsAPI);
            this.addAPI('pchain', api_10.PlatformVMAPI);
        }
    }
}
exports.default = Avalanche;
exports.Avalanche = Avalanche;
exports.utils = __importStar(require("./utils"));
exports.common = __importStar(require("./common"));
exports.admin = __importStar(require("./apis/admin"));
exports.auth = __importStar(require("./apis/auth"));
exports.avm = __importStar(require("./apis/avm"));
exports.evm = __importStar(require("./apis/evm"));
exports.health = __importStar(require("./apis/health"));
exports.info = __importStar(require("./apis/info"));
exports.index = __importStar(require("./apis/index"));
exports.keystore = __importStar(require("./apis/keystore"));
exports.metrics = __importStar(require("./apis/metrics"));
exports.platformvm = __importStar(require("./apis/platformvm"));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7R0FHRztBQUNILDREQUF3QztBQTRKL0Isd0JBNUpGLG1CQUFhLENBNEpFO0FBM0p0QiwwQ0FBNEM7QUFDNUMseUNBQTBDO0FBQzFDLHdDQUF3QztBQUN4Qyx3Q0FBd0M7QUFDeEMsMkNBQThDO0FBQzlDLDBDQUE0QztBQUM1Qyx5Q0FBMEM7QUFDMUMsNkNBQWtEO0FBQ2xELDRDQUFnRDtBQUNoRCxnREFBc0Q7QUFDdEQsaURBQThDO0FBb0pyQyx1RkFwSkEsZUFBTSxPQW9KQTtBQW5KZiwyQ0FBd0M7QUFvSi9CLHVGQXBKQSxlQUFNLE9Bb0pBO0FBbkpmLGlEQUErRDtBQUMvRCw2REFBMEQ7QUFDMUQsZ0VBQXdDO0FBMkkvQixtQkEzSUYsa0JBQVEsQ0EySUU7QUExSWpCLG9EQUE0QjtBQTJJbkIsYUEzSUYsWUFBRSxDQTJJRTtBQTFJWCxrREFBdUI7QUE0SWQsYUE1SUYsZUFBRSxDQTRJRTtBQTNJWCxvQ0FBaUM7QUE0SXhCLHVGQTVJQSxlQUFNLE9BNElBO0FBMUlmOzs7Ozs7OztHQVFHO0FBQ0gsTUFBcUIsU0FBVSxTQUFRLG1CQUFhO0lBb0RsRDs7Ozs7Ozs7Ozs7Ozs7U0FjSztJQUNMLFlBQ0UsRUFBUyxFQUNULElBQVcsRUFDWCxXQUFrQixNQUFNLEVBQ3hCLFlBQW1CLDRCQUFnQixFQUNuQyxXQUFrQixTQUFTLEVBQzNCLFdBQWtCLFNBQVMsRUFDM0IsTUFBYSxTQUFTLEVBQ3RCLFdBQW1CLEtBQUs7UUFDeEIsS0FBSyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7UUEzRTVCOzthQUVLO1FBQ0wsVUFBSyxHQUFHLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBaUIsQ0FBQztRQUUxQzs7YUFFSztRQUNM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QUUsWUFBTSxFQUFFLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUNyRCxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxZQUFNLEVBQUUsZ0JBQWdCLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDMUQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsZUFBUyxDQUFDLENBQUM7WUFDakMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsYUFBTyxDQUFDLENBQUM7WUFDN0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsY0FBUSxDQUFDLENBQUM7WUFDL0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsaUJBQVcsQ0FBQyxDQUFDO1lBQ3JDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLGdCQUFVLENBQUMsQ0FBQztZQUNuQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxvQkFBYSxDQUFDLENBQUM7U0FDdEM7SUFDSCxDQUFDO0NBQ0Y7QUExSEQsNEJBMEhDO0FBRVEsOEJBQVM7QUFTbEIsaURBQWlDO0FBQ2pDLG1EQUFtQztBQUNuQyxzREFBc0M7QUFDdEMsb0RBQW9DO0FBQ3BDLGtEQUFrQztBQUNsQyxrREFBa0M7QUFDbEMsd0RBQXdDO0FBQ3hDLG9EQUFvQztBQUNwQyxzREFBc0M7QUFDdEMsNERBQTRDO0FBQzVDLDBEQUEwQztBQUMxQyxnRUFBZ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxuICogQG1vZHVsZSBBdmFsYW5jaGVcbiAqL1xuaW1wb3J0IEF2YWxhbmNoZUNvcmUgZnJvbSAnLi9hdmFsYW5jaGUnO1xuaW1wb3J0IHsgQWRtaW5BUEkgfSBmcm9tICcuL2FwaXMvYWRtaW4vYXBpJztcbmltcG9ydCB7IEF1dGhBUEkgfSBmcm9tICcuL2FwaXMvYXV0aC9hcGknO1xuaW1wb3J0IHsgQVZNQVBJIH0gZnJvbSAnLi9hcGlzL2F2bS9hcGknO1xuaW1wb3J0IHsgRVZNQVBJIH0gZnJvbSAnLi9hcGlzL2V2bS9hcGknO1xuaW1wb3J0IHsgSGVhbHRoQVBJIH0gZnJvbSAnLi9hcGlzL2hlYWx0aC9hcGknO1xuaW1wb3J0IHsgSW5kZXhBUEkgfSBmcm9tICcuL2FwaXMvaW5kZXgvYXBpJztcbmltcG9ydCB7IEluZm9BUEkgfSBmcm9tICcuL2FwaXMvaW5mby9hcGknO1xuaW1wb3J0IHsgS2V5c3RvcmVBUEkgfSBmcm9tICcuL2FwaXMva2V5c3RvcmUvYXBpJztcbmltcG9ydCB7IE1ldHJpY3NBUEkgfSBmcm9tICcuL2FwaXMvbWV0cmljcy9hcGknO1xuaW1wb3J0IHsgUGxhdGZvcm1WTUFQSSB9IGZyb20gJy4vYXBpcy9wbGF0Zm9ybXZtL2FwaSc7XG5pbXBvcnQgeyBTb2NrZXQgfSBmcm9tICcuL2FwaXMvc29ja2V0L3NvY2tldCc7XG5pbXBvcnQgeyBQdWJTdWIgfSBmcm9tICcuL3V0aWxzL3B1YnN1Yic7XG5pbXBvcnQgeyBEZWZhdWx0TmV0d29ya0lELCBEZWZhdWx0cyB9IGZyb20gJy4vdXRpbHMvY29uc3RhbnRzJztcbmltcG9ydCB7IGdldFByZWZlcnJlZEhSUCB9IGZyb20gJy4vdXRpbHMvaGVscGVyZnVuY3Rpb25zJztcbmltcG9ydCBCaW5Ub29scyBmcm9tICcuL3V0aWxzL2JpbnRvb2xzJztcbmltcG9ydCBEQiBmcm9tICcuL3V0aWxzL2RiJztcbmltcG9ydCBCTiBmcm9tIFwiYm4uanNcIjtcbmltcG9ydCB7IEJ1ZmZlciB9IGZyb20gJ2J1ZmZlci8nO1xuXG4vKipcbiAqIEF2YWxhbmNoZUpTIGlzIG1pZGRsZXdhcmUgZm9yIGludGVyYWN0aW5nIHdpdGggQXZhbGFuY2hlIG5vZGUgUlBDIEFQSXMuXG4gKlxuICogRXhhbXBsZSB1c2FnZTpcbiAqIGBgYGpzXG4gKiBsZXQgYXZhbGFuY2hlID0gbmV3IEF2YWxhbmNoZShcIjEyNy4wLjAuMVwiLCA5NjUwLCBcImh0dHBzXCIpO1xuICogYGBgXG4gKlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBdmFsYW5jaGUgZXh0ZW5kcyBBdmFsYW5jaGVDb3JlIHtcbiAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgQWRtaW4gUlBDLlxuICAgICAqL1xuICBBZG1pbiA9ICgpID0+IHRoaXMuYXBpcy5hZG1pbiBhcyBBZG1pbkFQSTtcblxuICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBBdXRoIFJQQy5cbiAgICAgKi9cbiAgQXV0aCA9ICgpID0+IHRoaXMuYXBpcy5hdXRoIGFzIEF1dGhBUEk7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIEVWTUFQSSBSUEMgcG9pbnRlZCBhdCB0aGUgQy1DaGFpbi5cbiAgICovXG4gIENDaGFpbiA9ICgpID0+IHRoaXMuYXBpcy5jY2hhaW4gYXMgRVZNQVBJO1xuXG4gIC8qKlxuICAgICAqIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIEFWTSBSUEMgcG9pbnRlZCBhdCB0aGUgWC1DaGFpbi5cbiAgICAgKi9cbiAgWENoYWluID0gKCkgPT4gdGhpcy5hcGlzLnhjaGFpbiBhcyBBVk1BUEk7XG5cbiAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgSGVhbHRoIFJQQyBmb3IgYSBub2RlLlxuICAgICAqL1xuICBIZWFsdGggPSAoKSA9PiB0aGlzLmFwaXMuaGVhbHRoIGFzIEhlYWx0aEFQSTtcblxuICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBJbmRleCBSUEMgZm9yIGEgbm9kZS5cbiAgICAgKi9cbiAgSW5kZXggPSAoKSA9PiB0aGlzLmFwaXMuaW5kZXggYXMgSW5kZXhBUEk7XG5cbiAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgSW5mbyBSUEMgZm9yIGEgbm9kZS5cbiAgICAgKi9cbiAgSW5mbyA9ICgpID0+IHRoaXMuYXBpcy5pbmZvIGFzIEluZm9BUEk7XG5cbiAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgTWV0cmljcyBSUEMuXG4gICAgICovXG4gIE1ldHJpY3MgPSAoKSA9PiB0aGlzLmFwaXMubWV0cmljcyBhcyBNZXRyaWNzQVBJO1xuXG4gIC8qKlxuICAgICAqIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIEtleXN0b3JlIFJQQyBmb3IgYSBub2RlLiBXZSBsYWJlbCBpdCBcIk5vZGVLZXlzXCIgdG8gcmVkdWNlXG4gICAgICogY29uZnVzaW9uIGFib3V0IHdoYXQgaXQncyBhY2Nlc3NpbmcuXG4gICAgICovXG4gIE5vZGVLZXlzID0gKCkgPT4gdGhpcy5hcGlzLmtleXN0b3JlIGFzIEtleXN0b3JlQVBJO1xuXG4gIC8qKlxuICAgICAqIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIFBsYXRmb3JtVk0gUlBDIHBvaW50ZWQgYXQgdGhlIFAtQ2hhaW4uXG4gICAgICovXG4gIFBDaGFpbiA9ICgpID0+IHRoaXMuYXBpcy5wY2hhaW4gYXMgUGxhdGZvcm1WTUFQSTtcblxuICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IEF2YWxhbmNoZSBpbnN0YW5jZS4gU2V0cyB0aGUgYWRkcmVzcyBhbmQgcG9ydCBvZiB0aGUgbWFpbiBBdmFsYW5jaGUgQ2xpZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGlwIFRoZSBob3N0bmFtZSB0byByZXNvbHZlIHRvIHJlYWNoIHRoZSBBdmFsYW5jaGUgQ2xpZW50IFJQQyBBUElzXG4gICAgICogQHBhcmFtIHBvcnQgVGhlIHBvcnQgdG8gcmVzb2x2ZSB0byByZWFjaCB0aGUgQXZhbGFuY2hlIENsaWVudCBSUEMgQVBJc1xuICAgICAqIEBwYXJhbSBwcm90b2NvbCBUaGUgcHJvdG9jb2wgc3RyaW5nIHRvIHVzZSBiZWZvcmUgYSBcIjovL1wiIGluIGEgcmVxdWVzdCxcbiAgICAgKiBleDogXCJodHRwXCIsIFwiaHR0cHNcIiwgXCJnaXRcIiwgXCJ3c1wiLCBldGMgLi4uXG4gICAgICogQHBhcmFtIG5ldHdvcmtpZCBTZXRzIHRoZSBOZXR3b3JrSUQgb2YgdGhlIGNsYXNzLiBEZWZhdWx0IFtbRGVmYXVsdE5ldHdvcmtJRF1dXG4gICAgICogQHBhcmFtIFhDaGFpbklEIFNldHMgdGhlIGJsb2NrY2hhaW5JRCBmb3IgdGhlIEFWTS4gV2lsbCB0cnkgdG8gYXV0by1kZXRlY3QsXG4gICAgICogb3RoZXJ3aXNlIGRlZmF1bHQgXCI0UjVwMlJYREdMcWFpZlpFNGhIV0g5b3dlMzRwZm9CVUxuMURyUVRXaXZqZzhvNGFIXCJcbiAgICAgKiBAcGFyYW0gQ0NoYWluSUQgU2V0cyB0aGUgYmxvY2tjaGFpbklEIGZvciB0aGUgRVZNLiBXaWxsIHRyeSB0byBhdXRvLWRldGVjdCxcbiAgICAgKiBvdGhlcndpc2UgZGVmYXVsdCBcIjJxOWU0cjZNdTNVNjhuVTFmWWpnYlI2SnZ3clJ4MzZDb2hwQVg1VVF4c2U1NXgxUTVcIlxuICAgICAqIEBwYXJhbSBocnAgVGhlIGh1bWFuLXJlYWRhYmxlIHBhcnQgb2YgdGhlIGJlY2gzMiBhZGRyZXNzZXNcbiAgICAgKiBAcGFyYW0gc2tpcGluaXQgU2tpcHMgY3JlYXRpbmcgdGhlIEFQSXNcbiAgICAgKi9cbiAgY29uc3RydWN0b3IoXG4gICAgaXA6c3RyaW5nLFxuICAgIHBvcnQ6bnVtYmVyLFxuICAgIHByb3RvY29sOnN0cmluZyA9ICdodHRwJyxcbiAgICBuZXR3b3JrSUQ6bnVtYmVyID0gRGVmYXVsdE5ldHdvcmtJRCxcbiAgICBYQ2hhaW5JRDpzdHJpbmcgPSB1bmRlZmluZWQsXG4gICAgQ0NoYWluSUQ6c3RyaW5nID0gdW5kZWZpbmVkLFxuICAgIGhycDpzdHJpbmcgPSB1bmRlZmluZWQsXG4gICAgc2tpcGluaXQ6Ym9vbGVhbiA9IGZhbHNlKSB7XG4gICAgc3VwZXIoaXAsIHBvcnQsIHByb3RvY29sKTtcbiAgICBsZXQgeGNoYWluaWQgPSBYQ2hhaW5JRDtcbiAgICBsZXQgY2NoYWluaWQgPSBDQ2hhaW5JRDtcblxuICAgIGlmICh0eXBlb2YgWENoYWluSUQgPT09ICd1bmRlZmluZWQnXG4gICAgfHwgIVhDaGFpbklEXG4gICAgfHwgWENoYWluSUQudG9Mb3dlckNhc2UoKSA9PT0gJ3gnKSB7XG4gICAgICBpZiAobmV0d29ya0lELnRvU3RyaW5nKCkgaW4gRGVmYXVsdHMubmV0d29yaykge1xuICAgICAgICB4Y2hhaW5pZCA9IERlZmF1bHRzLm5ldHdvcmtbbmV0d29ya0lEXS5YLmJsb2NrY2hhaW5JRDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHhjaGFpbmlkID0gRGVmYXVsdHMubmV0d29ya1sxMjM0NV0uWC5ibG9ja2NoYWluSUQ7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0eXBlb2YgQ0NoYWluSUQgPT09ICd1bmRlZmluZWQnXG4gICAgfHwgIUNDaGFpbklEXG4gICAgfHwgQ0NoYWluSUQudG9Mb3dlckNhc2UoKSA9PT0gJ2MnKSB7XG4gICAgICBpZiAobmV0d29ya0lELnRvU3RyaW5nKCkgaW4gRGVmYXVsdHMubmV0d29yaykge1xuICAgICAgICBjY2hhaW5pZCA9IERlZmF1bHRzLm5ldHdvcmtbbmV0d29ya0lEXS5DLmJsb2NrY2hhaW5JRDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNjaGFpbmlkID0gRGVmYXVsdHMubmV0d29ya1sxMjM0NV0uQy5ibG9ja2NoYWluSUQ7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0eXBlb2YgbmV0d29ya0lEID09PSAnbnVtYmVyJyAmJiBuZXR3b3JrSUQgPj0gMCkge1xuICAgICAgdGhpcy5uZXR3b3JrSUQgPSBuZXR3b3JrSUQ7XG4gICAgfSBlbHNlIGlmKHR5cGVvZiBuZXR3b3JrSUQgPT09IFwidW5kZWZpbmVkXCIpe1xuICAgICAgbmV0d29ya0lEID0gRGVmYXVsdE5ldHdvcmtJRDtcbiAgICB9XG4gICAgaWYodHlwZW9mIGhycCAhPT0gXCJ1bmRlZmluZWRcIil7XG4gICAgICB0aGlzLmhycCA9IGhycDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ocnAgPSBnZXRQcmVmZXJyZWRIUlAodGhpcy5uZXR3b3JrSUQpO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIXNraXBpbml0KSB7XG4gICAgICB0aGlzLmFkZEFQSSgnYWRtaW4nLCBBZG1pbkFQSSk7XG4gICAgICB0aGlzLmFkZEFQSSgnYXV0aCcsIEF1dGhBUEkpO1xuICAgICAgdGhpcy5hZGRBUEkoJ3hjaGFpbicsIEFWTUFQSSwgJy9leHQvYmMvWCcsIHhjaGFpbmlkKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdjY2hhaW4nLCBFVk1BUEksICcvZXh0L2JjL0MvYXZheCcsIGNjaGFpbmlkKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdoZWFsdGgnLCBIZWFsdGhBUEkpO1xuICAgICAgdGhpcy5hZGRBUEkoJ2luZm8nLCBJbmZvQVBJKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdpbmRleCcsIEluZGV4QVBJKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdrZXlzdG9yZScsIEtleXN0b3JlQVBJKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdtZXRyaWNzJywgTWV0cmljc0FQSSk7XG4gICAgICB0aGlzLmFkZEFQSSgncGNoYWluJywgUGxhdGZvcm1WTUFQSSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB7IEF2YWxhbmNoZSB9O1xuZXhwb3J0IHsgQmluVG9vbHMgfTtcbmV4cG9ydCB7IERCIH07XG5leHBvcnQgeyBBdmFsYW5jaGVDb3JlIH07XG5leHBvcnQgeyBCTiB9O1xuZXhwb3J0IHsgQnVmZmVyIH07XG5leHBvcnQgeyBTb2NrZXQgfTtcbmV4cG9ydCB7IFB1YlN1YiB9O1xuXG5leHBvcnQgKiBhcyB1dGlscyBmcm9tICcuL3V0aWxzJztcbmV4cG9ydCAqIGFzIGNvbW1vbiBmcm9tICcuL2NvbW1vbic7XG5leHBvcnQgKiBhcyBhZG1pbiBmcm9tICcuL2FwaXMvYWRtaW4nO1xuZXhwb3J0ICogYXMgYXV0aCBmcm9tICcuL2FwaXMvYXV0aCc7XG5leHBvcnQgKiBhcyBhdm0gZnJvbSAnLi9hcGlzL2F2bSc7XG5leHBvcnQgKiBhcyBldm0gZnJvbSAnLi9hcGlzL2V2bSc7XG5leHBvcnQgKiBhcyBoZWFsdGggZnJvbSAnLi9hcGlzL2hlYWx0aCc7XG5leHBvcnQgKiBhcyBpbmZvIGZyb20gJy4vYXBpcy9pbmZvJztcbmV4cG9ydCAqIGFzIGluZGV4IGZyb20gJy4vYXBpcy9pbmRleCc7XG5leHBvcnQgKiBhcyBrZXlzdG9yZSBmcm9tICcuL2FwaXMva2V5c3RvcmUnO1xuZXhwb3J0ICogYXMgbWV0cmljcyBmcm9tICcuL2FwaXMvbWV0cmljcyc7XG5leHBvcnQgKiBhcyBwbGF0Zm9ybXZtIGZyb20gJy4vYXBpcy9wbGF0Zm9ybXZtJztcblxuIl19