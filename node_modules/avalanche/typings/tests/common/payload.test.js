"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const buffer_1 = require("buffer/");
const payload_1 = require("src/utils/payload");
const bintools_1 = __importDefault(require("src/utils/bintools"));
const bn_js_1 = __importDefault(require("bn.js"));
const bech32 = __importStar(require("bech32"));
let payloadTypes = payload_1.PayloadTypes.getInstance();
let bintools = bintools_1.default.getInstance();
describe("Payload", () => {
    let hrp = "tests";
    let cb58str = "MBcQpm1PsdfBKYscN3AYP56MusRDMZGF9";
    let cb58buf = bintools.bufferToB58(bintools.cb58Decode(cb58str));
    let chex = "849c0F8c6d9942a2605517AeaBe00133Cb159f8D";
    let bech = bech32.encode(hrp, bech32.toWords(bintools.b58ToBuffer(cb58buf)));
    let binstr = "Bx4v7ytutz3";
    let utf8str = "I am the very model of a modern Major-General.";
    let utf8b58 = bintools.bufferToB58(buffer_1.Buffer.from(utf8str));
    let utf8hex = buffer_1.Buffer.from(utf8str).toString("hex");
    let utf8b64 = buffer_1.Buffer.from(utf8str).toString("base64");
    let bnhex = "deadbeef";
    let svgstr = "<svg>hi mom</svg>";
    let csvstr = "1,2,3,4,5\neverybody,in the,house,come along, let's ride";
    let jsonobj = { boom: "goes the dynamite" };
    let yamlstr = "---\nrootproperty: blah\nsection:\n  one: two\n  three: four\n  Foo: Bar\n  empty: ~";
    let emailstr = "example@example.com";
    let urlstr = "https://example.com";
    let ipfsstr = "QmUy4jh5mGNZvLkjies1RWM4YuvJh5o2FYopNPVYwrRVGV";
    let onionstr = "https://el33th4xor.onion";
    let magnetstr = "magnet:?xt=urn:btih:c12fe1c06bba254a9dc9f519b335aa7c1367a88a";
    test("PayloadTypes", () => {
        expect(() => { payloadTypes.select(867309); }).toThrow();
        expect(payloadTypes.lookupID("BIN")).toBe(0);
        let pl = payloadTypes.select(0, binstr);
        expect(payloadTypes.getTypeID(pl.toBuffer())).toBe(0);
        let pp = payloadTypes.getContent(pl.toBuffer());
        expect(bintools.b58ToBuffer(binstr).toString("hex")).toBe(pp.toString("hex"));
        expect(payloadTypes.lookupType(0)).toBe("BIN");
        expect(payloadTypes.recast(pl).toBuffer().toString("hex")).toBe(pl.toBuffer().toString("hex"));
    });
    let testTable = [
        ["BIN", binstr, binstr],
        ["UTF8", utf8str, utf8b58],
        ["HEXSTR", utf8hex, utf8b58],
        ["B58STR", utf8b58, utf8b58],
        ["B64STR", utf8b64, utf8b58],
        ["BIGNUM", bnhex, bintools.bufferToB58(buffer_1.Buffer.from(bnhex, "hex"))],
        ["XCHAINADDR", "X-" + bech, cb58buf],
        ["PCHAINADDR", "P-" + bech, cb58buf],
        ["CCHAINADDR", "C-" + bech, cb58buf],
        ["TXID", cb58str, cb58buf],
        ["ASSETID", cb58str, cb58buf],
        ["UTXOID", cb58str, cb58buf],
        ["NFTID", cb58str, cb58buf],
        ["SUBNETID", cb58str, cb58buf],
        ["CHAINID", cb58str, cb58buf],
        ["NODEID", cb58str, cb58buf],
        ["SECPSIG", cb58str, cb58str],
        ["SECPENC", cb58str, cb58str],
        ["JPEG", binstr, binstr],
        ["PNG", binstr, binstr],
        ["BMP", binstr, binstr],
        ["ICO", binstr, binstr],
        ["SVG", svgstr, bintools.bufferToB58(buffer_1.Buffer.from(svgstr))],
        ["CSV", csvstr, bintools.bufferToB58(buffer_1.Buffer.from(csvstr))],
        ["JSON", JSON.stringify(jsonobj), bintools.bufferToB58(buffer_1.Buffer.from(JSON.stringify(jsonobj)))],
        ["YAML", yamlstr, bintools.bufferToB58(buffer_1.Buffer.from(yamlstr))],
        ["EMAIL", emailstr, bintools.bufferToB58(buffer_1.Buffer.from(emailstr))],
        ["URL", urlstr, bintools.bufferToB58(buffer_1.Buffer.from(urlstr))],
        ["IPFS", ipfsstr, ipfsstr],
        ["ONION", onionstr, bintools.bufferToB58(buffer_1.Buffer.from(onionstr))],
        ["MAGNET", magnetstr, bintools.bufferToB58(buffer_1.Buffer.from(magnetstr))]
    ];
    test.each(testTable)('Basic Payload Test: typestr %s; input %s; inputbuff %s', (typestr, inputstr, inputbuff) => {
        let buff = bintools.b58ToBuffer(inputbuff);
        let typeid = payloadTypes.lookupID(typestr);
        let typename = payloadTypes.lookupType(typeid);
        expect(typename).toBe(typestr);
        let c0 = payloadTypes.select(typeid);
        expect(c0.typeID()).toBe(typeid);
        expect(c0.typeName()).toBe(typename);
        let c1 = payloadTypes.select(typeid, buff);
        let c2 = payloadTypes.select(typeid, inputstr, hrp);
        let c3 = payloadTypes.select(typeid);
        c3.fromBuffer(c1.toBuffer());
        let c4 = payloadTypes.select(typeid);
        c4.fromBuffer(c2.toBuffer());
        let s1 = c1.toBuffer().toString("hex");
        let s2 = c2.toBuffer().toString("hex");
        let s3 = c3.toBuffer().toString("hex");
        let s4 = c4.toBuffer().toString("hex");
        expect(s1).toBe(s2);
        expect(s2).toBe(s3);
        expect(s3).toBe(s4);
    });
    test("BINPayload special cases", () => {
        let pl = payloadTypes.select(0, binstr);
        expect(bintools.bufferToB58(pl.returnType())).toBe(binstr);
    });
    test("UTF8Payload special cases", () => {
        let pl = new payload_1.UTF8Payload(utf8str);
        expect(pl.returnType()).toBe(utf8str);
    });
    test("HEXSTRPayload special cases", () => {
        let pl = new payload_1.HEXSTRPayload(utf8hex);
        expect(pl.returnType()).toBe(utf8hex);
    });
    test("B58STRPayload special cases", () => {
        let pl = new payload_1.B58STRPayload(utf8b58);
        expect(pl.returnType()).toBe(utf8b58);
    });
    test("B64STRPayload special cases", () => {
        let pl = new payload_1.B64STRPayload(utf8b64);
        expect(pl.returnType()).toBe(utf8b64);
    });
    test("BIGNUMPayload special cases", () => {
        let jenny = new bn_js_1.default(8675309);
        let pl = new payload_1.BIGNUMPayload(jenny);
        expect(pl.returnType().toString("hex")).toBe(jenny.toString("hex"));
    });
    test("XCHAINADDRPayload special cases", () => {
        let addr = "X-" + bech;
        let pl = new payload_1.XCHAINADDRPayload(addr, hrp);
        expect(pl.returnType(hrp)).toBe(addr);
        expect(pl.returnChainID()).toBe("X");
    });
    test("PCHAINADDRPayload special cases", () => {
        let addr = "P-" + bech;
        let pl = new payload_1.PCHAINADDRPayload(addr, hrp);
        expect(pl.returnType(hrp)).toBe(addr);
        expect(pl.returnChainID()).toBe("P");
    });
    test("CCHAINADDRPayload special cases", () => {
        let addr = "C-" + bech;
        let pl = new payload_1.CCHAINADDRPayload(addr, hrp);
        expect(pl.returnType(hrp)).toBe(addr);
        expect(pl.returnChainID()).toBe("C");
    });
    //handles all of cb58EncodedPayload
    test("TXIDPayload special cases", () => {
        let pl = new payload_1.TXIDPayload(cb58str);
        expect(pl.returnType()).toBe(cb58str);
    });
    test("JSONPayload special cases", () => {
        let pl = new payload_1.JSONPayload(jsonobj);
        expect(JSON.stringify(pl.returnType())).toBe(JSON.stringify(jsonobj));
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGF5bG9hZC50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vdGVzdHMvY29tbW9uL3BheWxvYWQudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxvQ0FBaUM7QUFDakMsK0NBQXNPO0FBQ3RPLGtFQUEwQztBQUMxQyxrREFBdUI7QUFDdkIsK0NBQWlDO0FBQ2pDLElBQUksWUFBWSxHQUFnQixzQkFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO0FBQzNELElBQUksUUFBUSxHQUFHLGtCQUFRLENBQUMsV0FBVyxFQUFFLENBQUE7QUFFckMsUUFBUSxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7SUFDckIsSUFBSSxHQUFHLEdBQVUsT0FBTyxDQUFDO0lBRXpCLElBQUksT0FBTyxHQUFVLG1DQUFtQyxDQUFDO0lBQ3pELElBQUksT0FBTyxHQUFVLFFBQVEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ3hFLElBQUksSUFBSSxHQUFVLDBDQUEwQyxDQUFDO0lBQzdELElBQUksSUFBSSxHQUFVLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDcEYsSUFBSSxNQUFNLEdBQVUsYUFBYSxDQUFDO0lBQ2xDLElBQUksT0FBTyxHQUFVLGdEQUFnRCxDQUFDO0lBQ3RFLElBQUksT0FBTyxHQUFVLFFBQVEsQ0FBQyxXQUFXLENBQUMsZUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLElBQUksT0FBTyxHQUFVLGVBQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzFELElBQUksT0FBTyxHQUFVLGVBQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzdELElBQUksS0FBSyxHQUFVLFVBQVUsQ0FBQztJQUM5QixJQUFJLE1BQU0sR0FBVSxtQkFBbUIsQ0FBQztJQUN4QyxJQUFJLE1BQU0sR0FBVSwwREFBMEQsQ0FBQztJQUMvRSxJQUFJLE9BQU8sR0FBVSxFQUFDLElBQUksRUFBQyxtQkFBbUIsRUFBQyxDQUFDO0lBQ2hELElBQUksT0FBTyxHQUFVLHNGQUFzRixDQUFDO0lBQzVHLElBQUksUUFBUSxHQUFVLHFCQUFxQixDQUFDO0lBQzVDLElBQUksTUFBTSxHQUFVLHFCQUFxQixDQUFDO0lBQzFDLElBQUksT0FBTyxHQUFVLGdEQUFnRCxDQUFDO0lBQ3RFLElBQUksUUFBUSxHQUFVLDBCQUEwQixDQUFDO0lBQ2pELElBQUksU0FBUyxHQUFVLDhEQUE4RCxDQUFDO0lBSXRGLElBQUksQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO1FBQ3RCLE1BQU0sQ0FBQyxHQUFHLEVBQUUsR0FBRSxZQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBLENBQUEsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFdEQsTUFBTSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFN0MsSUFBSSxFQUFFLEdBQWMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFlLENBQUM7UUFFakUsTUFBTSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFdEQsSUFBSSxFQUFFLEdBQVUsWUFBWSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUV2RCxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzlFLE1BQU0sQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQy9DLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDbkcsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLFNBQVMsR0FBRztRQUNaLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUM7UUFDdkIsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQztRQUMxQixDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDO1FBQzVCLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUM7UUFDNUIsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQztRQUM1QixDQUFDLFFBQVEsRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDLFdBQVcsQ0FBQyxlQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ2xFLENBQUMsWUFBWSxFQUFFLElBQUksR0FBRyxJQUFJLEVBQUUsT0FBTyxDQUFDO1FBQ3BDLENBQUMsWUFBWSxFQUFFLElBQUksR0FBRyxJQUFJLEVBQUUsT0FBTyxDQUFDO1FBQ3BDLENBQUMsWUFBWSxFQUFFLElBQUksR0FBRyxJQUFJLEVBQUUsT0FBTyxDQUFDO1FBQ3BDLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUM7UUFDMUIsQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FB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QUVILElBQUksQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7UUFDekMsSUFBSSxJQUFJLEdBQVUsSUFBSSxHQUFHLElBQUksQ0FBQztRQUM5QixJQUFJLEVBQUUsR0FBcUIsSUFBSSwyQkFBaUIsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDNUQsTUFBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN6QyxDQUFDLENBQUMsQ0FBQztJQUVILG1DQUFtQztJQUNuQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO1FBQ25DLElBQUksRUFBRSxHQUFlLElBQUkscUJBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM5QyxNQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzFDLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtRQUNuQyxJQUFJLEVBQUUsR0FBZSxJQUFJLHFCQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDOUMsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQzFFLENBQUMsQ0FBQyxDQUFDO0FBRVgsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCdWZmZXIgfSBmcm9tIFwiYnVmZmVyL1wiO1xuaW1wb3J0IHsgUGF5bG9hZFR5cGVzLCBCSU5QYXlsb2FkLCBQYXlsb2FkQmFzZSwgVVRGOFBheWxvYWQsIEhFWFNUUlBheWxvYWQsIEI1OFNUUlBheWxvYWQsIEI2NFNUUlBheWxvYWQsIEJJR05VTVBheWxvYWQsIFhDSEFJTkFERFJQYXlsb2FkLCBQQ0hBSU5BRERSUGF5bG9hZCwgQ0NIQUlOQUREUlBheWxvYWQsIFRYSURQYXlsb2FkLCBKU09OUGF5bG9hZCB9IGZyb20gJ3NyYy91dGlscy9wYXlsb2FkJztcbmltcG9ydCBCaW5Ub29scyBmcm9tICdzcmMvdXRpbHMvYmludG9vbHMnO1xuaW1wb3J0IEJOIGZyb20gXCJibi5qc1wiO1xuaW1wb3J0ICogYXMgYmVjaDMyIGZyb20gJ2JlY2gzMic7XG5sZXQgcGF5bG9hZFR5cGVzOlBheWxvYWRUeXBlcyA9IFBheWxvYWRUeXBlcy5nZXRJbnN0YW5jZSgpO1xubGV0IGJpbnRvb2xzID0gQmluVG9vbHMuZ2V0SW5zdGFuY2UoKVxuXG5kZXNjcmliZShcIlBheWxvYWRcIiwgKCkgPT4ge1xuICAgIGxldCBocnA6c3RyaW5nID0gXCJ0ZXN0c1wiO1xuXG4gICAgbGV0IGNiNThzdHI6c3RyaW5nID0gXCJNQmNRcG0xUHNkZkJLWXNjTjNBWVA1Nk11c1JETVpHRjlcIjtcbiAgICBsZXQgY2I1OGJ1ZjpzdHJpbmcgPSBiaW50b29scy5idWZmZXJUb0I1OChiaW50b29scy5jYjU4RGVjb2RlKGNiNThzdHIpKTtcbiAgICBsZXQgY2hleDpzdHJpbmcgPSBcIjg0OWMwRjhjNmQ5OTQyYTI2MDU1MTdBZWFCZTAwMTMzQ2IxNTlmOERcIjtcbiAgICBsZXQgYmVjaDpzdHJpbmcgPSBiZWNoMzIuZW5jb2RlKGhycCwgYmVjaDMyLnRvV29yZHMoYmludG9vbHMuYjU4VG9CdWZmZXIoY2I1OGJ1ZikpKTtcbiAgICBsZXQgYmluc3RyOnN0cmluZyA9IFwiQng0djd5dHV0ejNcIjtcbiAgICBsZXQgdXRmOHN0cjpzdHJpbmcgPSBcIkkgYW0gdGhlIHZlcnkgbW9kZWwgb2YgYSBtb2Rlcm4gTWFqb3ItR2VuZXJhbC5cIjtcbiAgICBsZXQgdXRmOGI1ODpzdHJpbmcgPSBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbSh1dGY4c3RyKSk7XG4gICAgbGV0IHV0ZjhoZXg6c3RyaW5nID0gQnVmZmVyLmZyb20odXRmOHN0cikudG9TdHJpbmcoXCJoZXhcIik7XG4gICAgbGV0IHV0ZjhiNjQ6c3RyaW5nID0gQnVmZmVyLmZyb20odXRmOHN0cikudG9TdHJpbmcoXCJiYXNlNjRcIik7XG4gICAgbGV0IGJuaGV4OnN0cmluZyA9IFwiZGVhZGJlZWZcIjtcbiAgICBsZXQgc3Znc3RyOnN0cmluZyA9IFwiPHN2Zz5oaSBtb208L3N2Zz5cIjtcbiAgICBsZXQgY3N2c3RyOnN0cmluZyA9IFwiMSwyLDMsNCw1XFxuZXZlcnlib2R5LGluIHRoZSxob3VzZSxjb21lIGFsb25nLCBsZXQncyByaWRlXCI7XG4gICAgbGV0IGpzb25vYmo6b2JqZWN0ID0ge2Jvb206XCJnb2VzIHRoZSBkeW5hbWl0ZVwifTtcbiAgICBsZXQgeWFtbHN0cjpzdHJpbmcgPSBcIi0tLVxcbnJvb3Rwcm9wZXJ0eTogYmxhaFxcbnNlY3Rpb246XFxuICBvbmU6IHR3b1xcbiAgdGhyZWU6IGZvdXJcXG4gIEZvbzogQmFyXFxuICBlbXB0eTogflwiO1xuICAgIGxldCBlbWFpbHN0cjpzdHJpbmcgPSBcImV4YW1wbGVAZXhhbXBsZS5jb21cIjtcbiAgICBsZXQgdXJsc3RyOnN0cmluZyA9IFwiaHR0cHM6Ly9leGFtcGxlLmNvbVwiO1xuICAgIGxldCBpcGZzc3RyOnN0cmluZyA9IFwiUW1VeTRqaDVtR05adkxramllczFSV000WXV2Smg1bzJGWW9wTlBWWXdyUlZHVlwiO1xuICAgIGxldCBvbmlvbnN0cjpzdHJpbmcgPSBcImh0dHBzOi8vZWwzM3RoNHhvci5vbmlvblwiO1xuICAgIGxldCBtYWduZXRzdHI6c3RyaW5nID0gXCJtYWduZXQ6P3h0PXVybjpidGloOmMxMmZlMWMwNmJiYTI1NGE5ZGM5ZjUxOWIzMzVhYTdjMTM2N2E4OGFcIjtcblxuICAgIFxuXG4gICAgdGVzdChcIlBheWxvYWRUeXBlc1wiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdCgoKSA9PiB7cGF5bG9hZFR5cGVzLnNlbGVjdCg4NjczMDkpfSkudG9UaHJvdygpO1xuXG4gICAgICAgIGV4cGVjdChwYXlsb2FkVHlwZXMubG9va3VwSUQoXCJCSU5cIikpLnRvQmUoMCk7XG5cbiAgICAgICAgbGV0IHBsOkJJTlBheWxvYWQgPSBwYXlsb2FkVHlwZXMuc2VsZWN0KDAsIGJpbnN0cikgYXMgQklOUGF5bG9hZDtcblxuICAgICAgICBleHBlY3QocGF5bG9hZFR5cGVzLmdldFR5cGVJRChwbC50b0J1ZmZlcigpKSkudG9CZSgwKTtcblxuICAgICAgICBsZXQgcHA6QnVmZmVyID0gcGF5bG9hZFR5cGVzLmdldENvbnRlbnQocGwudG9CdWZmZXIoKSk7XG5cbiAgICAgICAgZXhwZWN0KGJpbnRvb2xzLmI1OFRvQnVmZmVyKGJpbnN0cikudG9TdHJpbmcoXCJoZXhcIikpLnRvQmUocHAudG9TdHJpbmcoXCJoZXhcIikpO1xuICAgICAgICBleHBlY3QocGF5bG9hZFR5cGVzLmxvb2t1cFR5cGUoMCkpLnRvQmUoXCJCSU5cIik7XG4gICAgICAgIGV4cGVjdChwYXlsb2FkVHlwZXMucmVjYXN0KHBsKS50b0J1ZmZlcigpLnRvU3RyaW5nKFwiaGV4XCIpKS50b0JlKHBsLnRvQnVmZmVyKCkudG9TdHJpbmcoXCJoZXhcIikpO1xuICAgIH0pO1xuXG4gICAgbGV0IHRlc3RUYWJsZSA9IFtcbiAgICAgICAgW1wiQklOXCIsIGJpbnN0ciwgYmluc3RyXSwgXG4gICAgICAgIFtcIlVURjhcIiwgdXRmOHN0ciwgdXRmOGI1OF0sIFxuICAgICAgICBbXCJIRVhTVFJcIiwgdXRmOGhleCwgdXRmOGI1OF0sIFxuICAgICAgICBbXCJCNThTVFJcIiwgdXRmOGI1OCwgdXRmOGI1OF0sIFxuICAgICAgICBbXCJCNjRTVFJcIiwgdXRmOGI2NCwgdXRmOGI1OF0sIFxuICAgICAgICBbXCJCSUdOVU1cIiwgYm5oZXgsIGJpbnRvb2xzLmJ1ZmZlclRvQjU4KEJ1ZmZlci5mcm9tKGJuaGV4LCBcImhleFwiKSldLCBcbiAgICAgICAgW1wiWENIQUlOQUREUlwiLCBcIlgtXCIgKyBiZWNoLCBjYjU4YnVmXSwgXG4gICAgICAgIFtcIlBDSEFJTkFERFJcIiwgXCJQLVwiICsgYmVjaCwgY2I1OGJ1Zl0sIFxuICAgICAgICBbXCJDQ0hBSU5BRERSXCIsIFwiQy1cIiArIGJlY2gsIGNiNThidWZdLCBcbiAgICAgICAgW1wiVFhJRFwiLCBjYjU4c3RyLCBjYjU4YnVmXSwgXG4gICAgICAgIFtcIkFTU0VUSURcIiwgY2I1OHN0ciwgY2I1OGJ1Zl0sIFxuICAgICAgICBbXCJVVFhPSURcIiwgIGNiNThzdHIsIGNiNThidWZdLCBcbiAgICAgICAgW1wiTkZUSURcIiwgY2I1OHN0ciwgY2I1OGJ1Zl0sIFxuICAgICAgICBbXCJTVUJORVRJRFwiLCBjYjU4c3RyLCBjYjU4YnVmXSwgXG4gICAgICAgIFtcIkNIQUlOSURcIiwgY2I1OHN0ciwgY2I1OGJ1Zl0sIFxuICAgICAgICBbXCJOT0RFSURcIiwgY2I1OHN0ciwgY2I1OGJ1Zl0sIFxuICAgICAgICBbXCJTRUNQU0lHXCIsIGNiNThzdHIsIGNiNThzdHJdLCBcbiAgICAgICAgW1wiU0VDUEVOQ1wiLCBjYjU4c3RyLCBjYjU4c3RyXSwgXG4gICAgICAgIFtcIkpQRUdcIiwgYmluc3RyLCBiaW5zdHJdLCBcbiAgICAgICAgW1wiUE5HXCIsIGJpbnN0ciwgYmluc3RyXSwgXG4gICAgICAgIFtcIkJNUFwiLCBiaW5zdHIsIGJpbnN0cl0sIFxuICAgICAgICBbXCJJQ09cIiwgYmluc3RyLCBiaW5zdHJdLCBcbiAgICAgICAgW1wiU1ZHXCIsIHN2Z3N0ciwgYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20oc3Znc3RyKSldLCBcbiAgICAgICAgW1wiQ1NWXCIsIGNzdnN0ciwgYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20oY3N2c3RyKSldLCBcbiAgICAgICAgW1wiSlNPTlwiLCBKU09OLnN0cmluZ2lmeShqc29ub2JqKSwgYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20oSlNPTi5zdHJpbmdpZnkoanNvbm9iaikpKV0sIFxuICAgICAgICBbXCJZQU1MXCIsIHlhbWxzdHIsIGJpbnRvb2xzLmJ1ZmZlclRvQjU4KEJ1ZmZlci5mcm9tKHlhbWxzdHIpKV0sIFxuICAgICAgICBbXCJFTUFJTFwiLCBlbWFpbHN0ciwgYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20oZW1haWxzdHIpKV0sIFxuICAgICAgICBbXCJVUkxcIiwgdXJsc3RyLCBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbSh1cmxzdHIpKV0sIFxuICAgICAgICBbXCJJUEZTXCIsIGlwZnNzdHIsIGlwZnNzdHJdLCBcbiAgICAgICAgW1wiT05JT05cIiwgb25pb25zdHIsIGJpbnRvb2xzLmJ1ZmZlclRvQjU4KEJ1ZmZlci5mcm9tKG9uaW9uc3RyKSldLCBcbiAgICAgICAgW1wiTUFHTkVUXCIsIG1hZ25ldHN0ciwgYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20obWFnbmV0c3RyKSldXG4gICAgXTtcbiAgICB0ZXN0LmVhY2godGVzdFRhYmxlKShcbiAgICAgICAgJ0Jhc2ljIFBheWxvYWQgVGVzdDogdHlwZXN0ciAlczsgaW5wdXQgJXM7IGlucHV0YnVmZiAlcycsXG4gICAgICAgIChcbiAgICAgICAgICAgIHR5cGVzdHI6c3RyaW5nLCBpbnB1dHN0cjpzdHJpbmcsIGlucHV0YnVmZjpzdHJpbmdcbiAgICAgICAgKSA9PiB7XG4gICAgICAgICAgICBsZXQgYnVmZjpCdWZmZXIgPSBiaW50b29scy5iNThUb0J1ZmZlcihpbnB1dGJ1ZmYpO1xuICAgICAgICAgICAgbGV0IHR5cGVpZDpudW1iZXIgPSBwYXlsb2FkVHlwZXMubG9va3VwSUQodHlwZXN0cik7XG4gICAgICAgICAgICBsZXQgdHlwZW5hbWU6c3RyaW5nID0gcGF5bG9hZFR5cGVzLmxvb2t1cFR5cGUodHlwZWlkKTtcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlbmFtZSkudG9CZSh0eXBlc3RyKTtcbiAgICAgICAgICAgIGxldCBjMDpQYXlsb2FkQmFzZSA9IHBheWxvYWRUeXBlcy5zZWxlY3QodHlwZWlkKTtcbiAgICAgICAgICAgIGV4cGVjdChjMC50eXBlSUQoKSkudG9CZSh0eXBlaWQpO1xuICAgICAgICAgICAgZXhwZWN0KGMwLnR5cGVOYW1lKCkpLnRvQmUodHlwZW5hbWUpO1xuICAgICAgICAgICAgbGV0IGMxOlBheWxvYWRCYXNlID0gcGF5bG9hZFR5cGVzLnNlbGVjdCh0eXBlaWQsIGJ1ZmYpO1xuICAgICAgICAgICAgbGV0IGMyOlBheWxvYWRCYXNlID0gcGF5bG9hZFR5cGVzLnNlbGVjdCh0eXBlaWQsIGlucHV0c3RyLCBocnApO1xuICAgICAgICAgICAgbGV0IGMzOlBheWxvYWRCYXNlID0gcGF5bG9hZFR5cGVzLnNlbGVjdCh0eXBlaWQpO1xuICAgICAgICAgICAgYzMuZnJvbUJ1ZmZlcihjMS50b0J1ZmZlcigpKTtcbiAgICAgICAgICAgIGxldCBjNDpQYXlsb2FkQmFzZSA9IHBheWxvYWRUeXBlcy5zZWxlY3QodHlwZWlkKTtcbiAgICAgICAgICAgIGM0LmZyb21CdWZmZXIoYzIudG9CdWZmZXIoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxldCBzMTpzdHJpbmcgPSBjMS50b0J1ZmZlcigpLnRvU3RyaW5nKFwiaGV4XCIpO1xuICAgICAgICAgICAgbGV0IHMyOnN0cmluZyA9IGMyLnRvQnVmZmVyKCkudG9TdHJpbmcoXCJoZXhcIik7XG4gICAgICAgICAgICBsZXQgczM6c3RyaW5nID0gYzMudG9CdWZmZXIoKS50b1N0cmluZyhcImhleFwiKTtcbiAgICAgICAgICAgIGxldCBzNDpzdHJpbmcgPSBjNC50b0J1ZmZlcigpLnRvU3RyaW5nKFwiaGV4XCIpO1xuXG4gICAgICAgICAgICBleHBlY3QoczEpLnRvQmUoczIpO1xuICAgICAgICAgICAgZXhwZWN0KHMyKS50b0JlKHMzKTtcbiAgICAgICAgICAgIGV4cGVjdChzMykudG9CZShzNCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCSU5QYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkJJTlBheWxvYWQgPSBwYXlsb2FkVHlwZXMuc2VsZWN0KDAsIGJpbnN0cikgYXMgQklOUGF5bG9hZDtcbiAgICAgICAgICAgIGV4cGVjdChiaW50b29scy5idWZmZXJUb0I1OChwbC5yZXR1cm5UeXBlKCkpKS50b0JlKGJpbnN0cik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJVVEY4UGF5bG9hZCBzcGVjaWFsIGNhc2VzXCIsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBwbDpVVEY4UGF5bG9hZCA9IG5ldyBVVEY4UGF5bG9hZCh1dGY4c3RyKTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOHN0cik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJIRVhTVFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkhFWFNUUlBheWxvYWQgPSBuZXcgSEVYU1RSUGF5bG9hZCh1dGY4aGV4KTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOGhleCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCNThTVFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkI1OFNUUlBheWxvYWQgPSBuZXcgQjU4U1RSUGF5bG9hZCh1dGY4YjU4KTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOGI1OCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCNjRTVFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkI2NFNUUlBheWxvYWQgPSBuZXcgQjY0U1RSUGF5bG9hZCh1dGY4YjY0KTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOGI2NCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCSUdOVU1QYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGplbm55OkJOID0gbmV3IEJOKDg2NzUzMDkpO1xuICAgICAgICAgICAgbGV0IHBsOkJJR05VTVBheWxvYWQgPSBuZXcgQklHTlVNUGF5bG9hZChqZW5ueSk7XG4gICAgICAgICAgICBleHBlY3QocGwucmV0dXJuVHlwZSgpLnRvU3RyaW5nKFwiaGV4XCIpKS50b0JlKGplbm55LnRvU3RyaW5nKFwiaGV4XCIpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdChcIlhDSEFJTkFERFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGFkZHI6c3RyaW5nID0gXCJYLVwiICsgYmVjaDtcbiAgICAgICAgICAgIGxldCBwbDpYQ0hBSU5BRERSUGF5bG9hZCA9IG5ldyBYQ0hBSU5BRERSUGF5bG9hZChhZGRyLCBocnApO1xuICAgICAgICAgICAgZXhwZWN0KHBsLnJldHVyblR5cGUoaHJwKSkudG9CZShhZGRyKTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5DaGFpbklEKCkpLnRvQmUoXCJYXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KFwiUENIQUlOQUREUlBheWxvYWQgc3BlY2lhbCBjYXNlc1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgYWRkcjpzdHJpbmcgPSBcIlAtXCIgKyBiZWNoO1xuICAgICAgICAgICAgbGV0IHBsOlBDSEFJTkFERFJQYXlsb2FkID0gbmV3IFBDSEFJTkFERFJQYXlsb2FkKGFkZHIsIGhycCk7XG4gICAgICAgICAgICBleHBlY3QocGwucmV0dXJuVHlwZShocnApKS50b0JlKGFkZHIpO1xuICAgICAgICAgICAgZXhwZWN0KHBsLnJldHVybkNoYWluSUQoKSkudG9CZShcIlBcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJDQ0hBSU5BRERSUGF5bG9hZCBzcGVjaWFsIGNhc2VzXCIsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBhZGRyOnN0cmluZyA9IFwiQy1cIiArIGJlY2g7XG4gICAgICAgICAgICBsZXQgcGw6Q0NIQUlOQUREUlBheWxvYWQgPSBuZXcgQ0NIQUlOQUREUlBheWxvYWQoYWRkciwgaHJwKTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKGhycCkpLnRvQmUoYWRkcik7XG4gICAgICAgICAgICBleHBlY3QocGwucmV0dXJuQ2hhaW5JRCgpKS50b0JlKFwiQ1wiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9oYW5kbGVzIGFsbCBvZiBjYjU4RW5jb2RlZFBheWxvYWRcbiAgICAgICAgdGVzdChcIlRYSURQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOlRYSURQYXlsb2FkID0gbmV3IFRYSURQYXlsb2FkKGNiNThzdHIpO1xuICAgICAgICAgICAgZXhwZWN0KHBsLnJldHVyblR5cGUoKSkudG9CZShjYjU4c3RyKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdChcIkpTT05QYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkpTT05QYXlsb2FkID0gbmV3IEpTT05QYXlsb2FkKGpzb25vYmopO1xuICAgICAgICAgICAgZXhwZWN0KEpTT04uc3RyaW5naWZ5KHBsLnJldHVyblR5cGUoKSkpLnRvQmUoSlNPTi5zdHJpbmdpZnkoanNvbm9iaikpO1xuICAgICAgICB9KTtcblxufSk7XG4iXX0=